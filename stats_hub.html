<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; font-src 'self'; img-src 'self' data:; script-src 'self' 'unsafe-inline'; connect-src 'self';">
<title>Stats Learning Hub</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" id="themeColor" content="#0a0a0f">
<link rel="stylesheet" href="styles/stats_hub.css" fetchpriority="high">
</head>
<body>

<!-- STICKY PROGRESS -->
<div class="sticky-progress" id="stickyProgress" style="display:none;" aria-live="polite">
  <div class="sticky-progress-bar"><div class="sticky-progress-fill" id="stickyProgressFill"></div></div>
  <span class="sticky-progress-text" id="stickyProgressText">0 / 0</span>
</div>
<!-- SKIP NAV -->
<div class="offline-banner" id="offlineBanner" style="display:none;" role="alert">ğŸ“¡ You're offline â€” progress is saved locally</div>
<a class="skip-link" href="#main-content">Skip to main content</a>
<noscript>
  <p style="padding:40px;text-align:center;color:#e6e4f0;font-family:sans-serif;">
    This app requires JavaScript to run. Please enable JavaScript in your browser settings.
  </p>
</noscript>

<!-- TOP NAV -->
<nav class="top-nav" aria-label="Main navigation">
  <div class="nav-brand">Stats <em>Hub</em></div>
  <div class="nav-tabs" role="tablist" aria-label="Site sections">
    <button class="nav-tab active" id="tab-home" role="tab" aria-selected="true" aria-controls="page-home" onclick="goPage('home')">Home</button>
    <button class="nav-tab" id="tab-roadmap" role="tab" aria-selected="false" aria-controls="page-roadmap" onclick="goPage('roadmap')">Roadmap <span class="nav-badge" id="roadmapNavBadge" style="display:none;">0</span></button>
    <button class="nav-tab" id="tab-visualizer" role="tab" aria-selected="false" aria-controls="page-visualizer" onclick="goPage('visualizer')">Visualizer</button>
    <button class="nav-tab" id="tab-practice" role="tab" aria-selected="false" aria-controls="page-practice" onclick="goPage('practice')">Practice <span class="nav-badge" id="practiceNavBadge" style="display:none;">0</span></button>
    <button class="nav-tab" id="tab-review" role="tab" aria-selected="false" aria-controls="page-review" onclick="goPage('review')">Review <span class="review-badge" id="reviewBadge" style="display:none;">0</span></button>
    <button class="nav-tab" id="tab-achievements" role="tab" aria-selected="false" aria-controls="page-achievements" onclick="goPage('achievements')">Achievements</button>
    <button class="nav-tab" id="tab-flashcards" role="tab" aria-selected="false" aria-controls="page-flashcards" onclick="goPage('flashcards')">Flashcards</button>
    <button class="nav-tab" id="tab-create" role="tab" aria-selected="false" aria-controls="page-create" onclick="goPage('create')">Create</button>
  </div>
  <div class="nav-right">
    <div class="progress-pill" role="status" aria-live="polite">Topics: <span id="topicCount">0</span> / <span id="topicTotal">0</span></div>
    <div class="nav-pill" id="streakPill" aria-label="Study streak">
      <span id="streakIcon">ğŸ”¥</span>
      <span id="streakCount">0</span> day streak
      <span class="freeze-info" id="freezeInfo"></span>
    </div>
    <div class="nav-pill" id="xpPill" aria-label="Experience points">
      <span class="xp-level" id="xpLevel">Lv 1</span>
      <div class="xp-bar-mini">
        <div class="xp-bar-fill" id="xpBarFill"></div>
      </div>
      <span class="xp-total" id="xpTotal">0 XP</span>
    </div>
    <button class="reading-mode-btn" id="readingModeBtn" onclick="toggleReadingMode()" aria-label="Toggle reading mode" title="Reading Mode">ğŸ“–</button>
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" aria-label="Toggle light/dark theme">ğŸŒ™</button>
  </div>
</nav>

<div class="breadcrumb" id="breadcrumb" aria-label="Current location">Home</div>
<main id="main-content">

<!-- ==================== HOME ==================== -->
<section class="page active" id="page-home" role="tabpanel" aria-labelledby="tab-home">
  <header class="hero">
    <p class="hero-tag">College Intro Statistics</p>
    <h1>Stats Learning <em>Hub</em></h1>
    <p>Your all-in-one tool for learning statistics. Roadmap to track what to learn, interactive visualizations to build intuition, and practice problems to test your understanding.</p>
    <button class="export-all-btn" onclick="exportAllData()" style="margin-top:12px;">Export All Data</button>
    <blockquote class="motivational-quote" id="motivationalQuote"></blockquote>
  </header>
  <div class="quick-stats-row" id="quickStatsRow">
    <div class="quick-stat-item"><span class="quick-stat-value" id="qsAttempted">0</span><span class="quick-stat-label">Attempted</span></div>
    <div class="quick-stat-item"><span class="quick-stat-value" id="qsCorrect">0</span><span class="quick-stat-label">Correct</span></div>
    <div class="quick-stat-item"><span class="quick-stat-value" id="qsAccuracy">0%</span><span class="quick-stat-label">Accuracy</span></div>
    <div class="quick-stat-item"><span class="quick-stat-value" id="qsStreak">0</span><span class="quick-stat-label">Day Streak</span></div>
    <div class="quick-stat-item"><span class="quick-stat-value" id="qsToday">0</span><span class="quick-stat-label">Answered Today</span></div>
    <div class="quick-stat-item quick-stat-ring-item">
      <svg class="progress-ring" width="44" height="44" viewBox="0 0 44 44" aria-label="Units started progress ring">
        <circle class="progress-ring-bg" cx="22" cy="22" r="18" fill="none" stroke-width="4"/>
        <circle class="progress-ring-fill" id="qsRingFill" cx="22" cy="22" r="18" fill="none" stroke-width="4" stroke-dasharray="113.1" stroke-dashoffset="113.1" transform="rotate(-90 22 22)"/>
        <text class="progress-ring-text" x="22" y="26" text-anchor="middle" id="qsRingText">0</text>
      </svg>
      <span class="quick-stat-label">Units Started</span>
    </div>
  </div>
  <div class="recent-activity" id="recentActivity" style="display:none;"></div>
  <div class="streak-message" id="streakMessage"></div>
  <div class="streak-heatmap" id="streakHeatmap"></div>
  <canvas id="weeklyStatsChart" width="280" height="60" style="display:none;"></canvas>
  <div class="xp-breakdown" id="xpBreakdown"></div>
  <div class="study-plan" id="studyPlan"></div>
  <div class="recent-units-row" id="recentUnitsRow" style="display:none;"></div>
  <div class="daily-digest" id="dailyDigest" style="display:none;">
    <div class="digest-row">
      <div class="digest-stat">
        <span class="digest-num" id="digestStreak">0</span>
        <span class="digest-label">Day Streak</span>
      </div>
      <div class="digest-stat">
        <span class="digest-num" id="digestXP">0</span>
        <span class="digest-label">Total XP</span>
      </div>
      <div class="digest-stat">
        <span class="digest-num" id="digestLevel">1</span>
        <span class="digest-label">Level</span>
      </div>
      <div class="digest-stat">
        <span class="digest-num" id="digestDue">0</span>
        <span class="digest-label">Cards Due</span>
      </div>
      <div class="digest-stat">
        <span class="digest-num" id="digestBadges">0</span>
        <span class="digest-label">Badges</span>
      </div>
    </div>
    <div class="digest-cta" id="digestCTA">
      <!-- Single recommended action button inserted by JS -->
    </div>
    <div class="digest-next-milestone" id="digestMilestone">
      <!-- Next unlockable milestone shown here -->
    </div>
  </div>
  <div class="daily-challenge" id="dailyChallenge" style="display:none;">
    <div class="dc-header">
      <span class="dc-title">âš¡ Daily Challenge</span>
      <span class="dc-date" id="dcDate"></span>
      <span class="dc-streak" id="dcStreak">ğŸ”¥ 0</span>
    </div>
    <div class="dc-problems" id="dcProblems"></div>
    <div class="dc-status" id="dcStatus"></div>
    <div class="dc-history" id="dcHistory"></div>
  </div>
  <div class="weekly-goals" id="weeklyGoals" style="display:none;">
    <h4 class="wg-title">ğŸ“… This Week</h4>
    <div id="wgList"></div>
  </div>
  <div class="path-section" id="pathSection">
    <h3>Choose Your Learning Path</h3>
    <div class="path-grid" id="pathGrid"></div>
    <div class="active-path" id="activePath" style="display:none;">
      <div class="path-progress-bar"><div class="path-progress-fill" id="pathFill"></div></div>
      <span id="pathStatus">Unit 1 of 5</span>
      <button class="path-next-btn" id="pathNextBtn" onclick="goToPathUnit()">Continue â†’</button>
    </div>
  </div>
  <div class="goal-section" id="goalSection">
    <h3>ğŸ¯ Set a Goal</h3>
    <label>I want to finish my path by:
      <input type="date" id="goalDate" onchange="setGoal()" aria-label="Goal deadline date">
    </label>
    <div class="goal-countdown" id="goalCountdown" style="display:none;">
      <span class="goal-days" id="goalDays">0</span> days remaining
      <div class="goal-pace" id="goalPace"></div>
    </div>
    <button class="cert-btn" onclick="generateCertificate()">ğŸ“ Get Certificate</button>
  </div>
  <div class="pod-widget" id="podWidget" style="display:none;">
    <div class="pod-header">Problem of the Day</div>
    <div class="pod-question" id="podQuestion"></div>
    <button class="pod-solve-btn" id="podSolveBtn">Solve It â†’</button>
  </div>
  <div class="home-cards">
    <div class="home-card card-roadmap" onclick="goPage('roadmap')" role="button" tabindex="0" aria-label="Open Quant Roadmap" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();goPage('roadmap')}">
      <div class="card-icon" aria-hidden="true">&#x1f5fa;</div>
      <div class="card-title">Learn</div>
      <div class="card-desc">Quant Roadmap with 6 pillars &amp; 3 levels. Learning paths with deadlines. AI tutor for instant stats help. Custom problem creator.</div>
      <div class="card-meta">Roadmap &middot; Paths &middot; AI Tutor</div>
    </div>
    <div class="home-card card-viz" onclick="goPage('visualizer')" role="button" tabindex="0" aria-label="Open Interactive Visualizer" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();goPage('visualizer')}">
      <div class="card-icon" aria-hidden="true">&#x1f4ca;</div>
      <div class="card-title">Visualize</div>
      <div class="card-desc">14 real-time canvas visualizers. Upload your own CSV data or use built-in datasets. Live stats panel updates as you explore.</div>
      <div class="card-meta">14 visualizers &middot; CSV upload &middot; Real datasets</div>
    </div>
    <div class="home-card card-practice" onclick="goPage('practice')" role="button" tabindex="0" aria-label="Open Practice Problems" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();goPage('practice')}">
      <div class="card-icon" aria-hidden="true">&#x270f;</div>
      <div class="card-title">Practice</div>
      <div class="card-desc">145+ problems across 14 units with hints and step-by-step solutions. Flashcards, matching games, daily challenges, and spaced repetition review.</div>
      <div class="card-meta">145+ problems &middot; Flashcards &middot; Daily challenges</div>
    </div>
    <div class="home-card card-achievements" onclick="goPage('achievements')" role="button" tabindex="0" aria-label="Open Achievements" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();goPage('achievements')}">
      <div class="card-icon" aria-hidden="true">&#x1f3c6;</div>
      <div class="card-title">Track</div>
      <div class="card-desc">XP, streaks, and 15+ achievement badges. Activity heatmap, analytics charts, and study calendar. Earn certificates when you complete a learning path.</div>
      <div class="card-meta">XP &middot; Streaks &middot; Badges &middot; Certificates</div>
    </div>
  </div>
</section>

<!-- ==================== ROADMAP ==================== -->
<section class="page" id="page-roadmap" role="tabpanel" aria-labelledby="tab-roadmap">
  <header class="section-header">
    <p class="section-tag">An improved learning path</p>
    <h2 class="section-title">The Quant <em>Roadmap</em></h2>
    <p class="section-desc">Six pillars, three levels. Track your progress as you go.</p>
    <button class="roadmap-export-btn" onclick="exportRoadmapProgress()">Export Progress</button>
    <span class="roadmap-pct" id="roadmapPct">0%</span>
  </header>
  <div class="improvements-card">
    <h3 class="improvements-title">Improvements over the original</h3>
    <ul class="improvement-list" role="list">
      <li class="improvement-item"><span class="marker" aria-hidden="true">+</span> Monte Carlo, numerical methods, market microstructure</li>
      <li class="improvement-item"><span class="marker" aria-hidden="true">+</span> Data engineering, SQL, real-world pipelines</li>
      <li class="improvement-item"><span class="marker" aria-hidden="true">+</span> Measure theory bridging to stochastic calculus</li>
      <li class="improvement-item"><span class="marker" aria-hidden="true">+</span> Timelines and recommended resources per section</li>
      <li class="improvement-item"><span class="marker" aria-hidden="true">~</span> Rebalanced ML weight; reframed finance critique</li>
      <li class="improvement-item"><span class="marker" aria-hidden="true">+</span> New 6th pillar: Infrastructure &amp; Systems</li>
    </ul>
  </div>
  <div class="rm-search-wrap"><input type="text" id="rmSearch" placeholder="Search topics..." oninput="searchRoadmapTopics(this.value)" class="rm-search-input" aria-label="Search roadmap topics"><button class="rm-search-clear" id="rmSearchClear" onclick="clearRoadmapSearch()" style="display:none;">Ã—</button><button class="rm-export-btn" onclick="exportRoadmapProgress()" title="Export progress as JSON">Export Progress</button></div>
  <div class="sub-tabs" id="roadmapTabs" role="tablist" aria-label="Roadmap levels">
    <button class="sub-tab active" id="rm-tab-l1" role="tab" aria-selected="true" aria-controls="rm-l1" onclick="showSub('rm','l1',this)">Level 1</button>
    <button class="sub-tab" id="rm-tab-l2" role="tab" aria-selected="false" aria-controls="rm-l2" onclick="showSub('rm','l2',this)">Level 2</button>
    <button class="sub-tab" id="rm-tab-l3" role="tab" aria-selected="false" aria-controls="rm-l3" onclick="showSub('rm','l3',this)">Level 3</button>
    <button class="sub-tab" id="rm-tab-roles" role="tab" aria-selected="false" aria-controls="rm-roles" onclick="showSub('rm','roles',this)">Roles</button>
  </div>
  <div id="rm-panels"></div>
</section>

<!-- ==================== VISUALIZER ==================== -->
<section class="page" id="page-visualizer" role="tabpanel" aria-labelledby="tab-visualizer">
  <header class="section-header">
    <p class="section-tag" id="vizUnitTag">Unit 1 â€” Descriptive Statistics</p>
    <h2 class="section-title">Interactive <em>Visualizer</em></h2>
    <p class="section-desc">Play with data, build intuition. Everything updates in real time.</p>
  </header>
  <div class="unit-selector">
    <label class="cl" for="vizUnitSelect">UNIT</label>
    <select id="vizUnitSelect" onchange="setUnit(+this.value)">
      <option value="1">Unit 1: Descriptive Statistics</option>
      <option value="2">Unit 2: Normal Distribution</option>
      <option value="3">Unit 3: Bivariate Data</option>
      <option value="4">Unit 4: Sampling &amp; Design</option>
      <option value="5">Unit 5: Probability</option>
      <option value="6">Unit 6: Random Variables</option>
      <option value="7">Unit 7: Sampling Distributions</option>
      <option value="8">Unit 8: Confidence Intervals</option>
      <option value="9">Unit 9: Hypothesis Testing</option>
      <option value="10">Unit 10: Chi-Square Tests</option>
      <option value="11">Unit 11: Regression Inference</option>
      <option value="12">Unit 12: ANOVA</option>
      <option value="13">Unit 13: Nonparametric Tests</option>
      <option value="14">Unit 14: Bayesian Statistics</option>
    </select>
  </div>
  <div class="dataset-selector">
    <label class="cl" for="datasetSelect">DATASET</label>
    <select id="datasetSelect" onchange="loadDataset(this.value)">
      <option value="">Default (synthetic)</option>
      <option value="iris">Iris Flowers (sepal length)</option>
      <option value="grades">Exam Scores</option>
      <option value="housing">Home Prices (sqft)</option>
      <option value="custom">Upload CSV...</option>
    </select>
    <div class="data-stats" id="dataStats" style="display:none;">
      <span class="data-stat">n=<span id="dsN">0</span></span>
      <span class="data-stat">xÌ„=<span id="dsMean">0</span></span>
      <span class="data-stat">s=<span id="dsStdev">0</span></span>
      <span class="data-stat">med=<span id="dsMedian">0</span></span>
    </div>
  </div>
  <div class="viz-history-row" id="vizHistoryRow" style="display:none;"></div>
  <div class="viz-unit-info" id="vizUnitInfo">
    <button class="viz-unit-info-toggle" onclick="toggleVizInfo()">&#8505; Unit Info &#9656;</button>
    <div class="viz-unit-info-body" id="vizUnitInfoBody" style="display:none;"></div>
  </div>
  <div class="sub-tabs" id="vizTabs" role="tablist" aria-label="Visualizer tools">
    <button class="sub-tab active" id="viz-tab-hist" role="tab" aria-selected="true" aria-controls="viz-hist" onclick="showSub('viz','hist',this)">Histogram</button>
    <button class="sub-tab" id="viz-tab-box" role="tab" aria-selected="false" aria-controls="viz-box" onclick="showSub('viz','box',this)">Boxplot</button>
    <button class="sub-tab" id="viz-tab-norm" role="tab" aria-selected="false" aria-controls="viz-norm" onclick="showSub('viz','norm',this)">Normal Curve</button>
    <button class="sub-tab" id="viz-tab-comp" role="tab" aria-selected="false" aria-controls="viz-comp" onclick="showSub('viz','comp',this)">Compare</button>
  </div>
  <div class="viz-screenshot-row">
    <button class="viz-screenshot-btn" onclick="saveVizScreenshot()" title="Save current visualizer as PNG">ğŸ“· Save as PNG</button>
    <button class="viz-fullscreen-btn" onclick="toggleVizFullscreen()" title="Fullscreen visualizer">â›¶ Fullscreen</button>
  </div>
  <div id="viz-panels">
    <!-- Histogram -->
    <div class="sub-panel active" id="viz-hist" role="tabpanel" aria-labelledby="viz-tab-hist">
      <div class="viz-box">
        <h3 class="viz-title">Interactive Histogram</h3>
        <div class="viz-desc">See how shape, center, and spread change as you modify the data.</div>
        <canvas id="histCanvas" height="300" aria-label="Histogram visualization" role="img"></canvas>
        <div class="stats-row" aria-label="Histogram statistics">
          <div class="sc"><div class="sv sv-cyan" id="hMean">â€”</div><div class="sl">Mean</div></div>
          <div class="sc"><div class="sv sv-amber" id="hMedian">â€”</div><div class="sl">Median</div></div>
          <div class="sc"><div class="sv sv-pink" id="hMode">â€”</div><div class="sl">Mode</div></div>
          <div class="sc"><div class="sv sv-purple" id="hSD">â€”</div><div class="sl">Std Dev</div></div>
          <div class="sc"><div class="sv sv-green" id="hIQR">â€”</div><div class="sl">IQR</div></div>
          <div class="sc"><div class="sv sv-orange" id="hRange">â€”</div><div class="sl">Range</div></div>
        </div>
        <div class="controls">
          <div class="cg"><label class="cl" for="histPreset">Preset</label><select id="histPreset" onchange="loadPreset()"><option value="symmetric">Symmetric</option><option value="right">Right skewed</option><option value="left">Left skewed</option><option value="bimodal">Bimodal</option><option value="uniform">Uniform</option></select></div>
          <div class="cg"><label class="cl" for="binSlider">Bins</label><input type="range" id="binSlider" min="3" max="25" value="10" oninput="drawHist()"></div>
          <div class="cg"><label class="cl" for="sizeSlider">Sample size</label><input type="range" id="sizeSlider" min="20" max="500" value="100" oninput="loadPreset()"></div>
        </div>
        <div class="data-row">
          <input type="text" id="customData" placeholder="Or enter your own: 2, 5, 7, 3, 9, 12..." aria-label="Custom data input">
          <button class="btn-a" onclick="loadCustom()" style="padding:8px 16px;border-radius:6px;cursor:pointer;border:1px solid rgba(6,182,212,0.3);background:var(--cyan-g);color:var(--cyan);font-size:13px;">Load</button>
          <button class="viz-download-btn" onclick="downloadVizData()" title="Download current dataset as CSV">Download CSV</button>
        </div>
      </div>
      <div class="explain"><h3>What to notice</h3><p>The <strong style="color:var(--cyan)">mean</strong> is pulled toward the tail in skewed data. The <strong style="color:var(--amber)">median</strong> resists outliers. When mean > median â†’ right-skewed. When mean < median â†’ left-skewed.</p><div class="formula">Mean = Î£xáµ¢ / n &nbsp;&nbsp; Median = middle value when sorted</div></div>
    </div>

    <!-- Boxplot -->
    <div class="sub-panel" id="viz-box" role="tabpanel" aria-labelledby="viz-tab-box">
      <div class="viz-box">
        <h3 class="viz-title">Five-Number Summary & Boxplot</h3>
        <div class="viz-desc">Min, Q1, median, Q3, max. Drag the slider to add outliers.</div>
        <canvas id="boxCanvas" height="260" aria-label="Boxplot visualization" role="img"></canvas>
        <div class="stats-row" aria-label="Boxplot statistics">
          <div class="sc"><div class="sv sv-orange" id="bMin">â€”</div><div class="sl">Min</div></div>
          <div class="sc"><div class="sv sv-green" id="bQ1">â€”</div><div class="sl">Q1</div></div>
          <div class="sc"><div class="sv sv-amber" id="bMed">â€”</div><div class="sl">Median</div></div>
          <div class="sc"><div class="sv sv-green" id="bQ3">â€”</div><div class="sl">Q3</div></div>
          <div class="sc"><div class="sv sv-orange" id="bMax">â€”</div><div class="sl">Max</div></div>
          <div class="sc"><div class="sv sv-green" id="bIQR">â€”</div><div class="sl">IQR</div></div>
        </div>
        <div class="controls">
          <div class="cg"><label class="cl" for="boxPreset">Dataset</label><select id="boxPreset" onchange="drawBox()"><option value="symmetric">Symmetric</option><option value="right">Right skewed</option><option value="outliers">Has outliers</option></select></div>
          <div class="cg"><label class="cl" for="outlierSlider">Add extreme value</label><input type="range" id="outlierSlider" min="0" max="100" value="0" oninput="drawBox()"></div>
        </div>
        <div class="legend"><div class="leg-i"><div class="leg-d" style="background:var(--cyan)" aria-hidden="true"></div>Box (Q1â€“Q3)</div><div class="leg-i"><div class="leg-d" style="background:var(--amber)" aria-hidden="true"></div>Median</div><div class="leg-i"><div class="leg-d" style="background:var(--dim)" aria-hidden="true"></div>Whiskers</div><div class="leg-i"><div class="leg-d" style="background:var(--pink);border-radius:50%" aria-hidden="true"></div>Outliers</div></div>
      </div>
      <div class="explain"><h3>How to read a boxplot</h3><p>The box spans Q1 to Q3 (middle 50%). Whiskers extend to the furthest non-outlier point. An outlier is anything beyond 1.5Ã—IQR from the box edges.</p><div class="formula">IQR = Q3 âˆ’ Q1 &nbsp;&nbsp; Outlier if x &lt; Q1 âˆ’ 1.5Â·IQR or x &gt; Q3 + 1.5Â·IQR</div></div>
    </div>

    <!-- Normal -->
    <div class="sub-panel" id="viz-norm" role="tabpanel" aria-labelledby="viz-tab-norm">
      <div class="viz-box">
        <h3 class="viz-title">The Normal Distribution</h3>
        <div class="viz-desc">Adjust Î¼ and Ïƒ. The shaded regions show the 68-95-99.7 rule.</div>
        <canvas id="normCanvas" height="340" aria-label="Normal distribution visualization" role="img"></canvas>
        <div class="controls">
          <div class="cg"><label class="cl" for="muSlider">Î¼ (mean) <span class="sv-val" id="muVal">0</span></label><input type="range" id="muSlider" min="-4" max="4" value="0" step="0.1" oninput="drawNorm()"></div>
          <div class="cg"><label class="cl" for="sigSlider">Ïƒ (std dev) <span class="sv-val" id="sigVal">1</span></label><input type="range" id="sigSlider" min="0.3" max="3" value="1" step="0.1" oninput="drawNorm()"></div>
          <div class="cg"><label class="cl" for="normRegion">Region</label><select id="normRegion" onchange="drawNorm()"><option value="none">None</option><option value="68" selected>68% (Î¼Â±1Ïƒ)</option><option value="95">95% (Î¼Â±2Ïƒ)</option><option value="997">99.7% (Î¼Â±3Ïƒ)</option><option value="custom">Custom z</option></select></div>
          <div class="cg" id="zGrp" style="display:none"><label class="cl" for="zSlider">z <span class="sv-val" id="zVal">1.96</span></label><input type="range" id="zSlider" min="0" max="4" value="1.96" step="0.01" oninput="drawNorm()"></div>
        </div>
        <div class="stats-row" style="margin-top:14px" aria-label="Normal distribution statistics">
          <div class="sc"><div class="sv sv-cyan" id="nArea">68.3%</div><div class="sl">Shaded area</div></div>
          <div class="sc"><div class="sv sv-amber" id="nLeft">â€”</div><div class="sl">Left bound</div></div>
          <div class="sc"><div class="sv sv-purple" id="nRight">â€”</div><div class="sl">Right bound</div></div>
        </div>
      </div>
      <div class="explain"><h3>The 68-95-99.7 Rule</h3><p>In a normal distribution: <strong style="color:var(--cyan)">68%</strong> within 1Ïƒ, <strong style="color:var(--amber)">95%</strong> within 2Ïƒ, <strong style="color:var(--pink)">99.7%</strong> within 3Ïƒ. A z-score tells you how many standard deviations from the mean.</p><div class="formula">z = (x âˆ’ Î¼) / Ïƒ</div></div>
    </div>

    <!-- Compare -->
    <div class="sub-panel" id="viz-comp" role="tabpanel" aria-labelledby="viz-tab-comp">
      <div class="viz-box">
        <h3 class="viz-title">Compare Two Distributions</h3>
        <div class="viz-desc">Same mean, different spread? Same spread, different center? See how they're independent.</div>
        <canvas id="compCanvas" height="320" aria-label="Distribution comparison visualization" role="img"></canvas>
        <div class="controls">
          <div class="cg"><label class="cl" for="muAS">A: Î¼ <span class="sv-val" id="muA">0</span></label><input type="range" id="muAS" min="-4" max="4" value="0" step="0.1" oninput="drawComp()"></div>
          <div class="cg"><label class="cl" for="sigAS">A: Ïƒ <span class="sv-val" id="sigA">1</span></label><input type="range" id="sigAS" min="0.3" max="3" value="1" step="0.1" oninput="drawComp()"></div>
          <div class="cg"><label class="cl" for="muBS">B: Î¼ <span class="sv-val" id="muB">2</span></label><input type="range" id="muBS" min="-4" max="4" value="2" step="0.1" oninput="drawComp()"></div>
          <div class="cg"><label class="cl" for="sigBS">B: Ïƒ <span class="sv-val" id="sigB">0.7</span></label><input type="range" id="sigBS" min="0.3" max="3" value="0.7" step="0.1" oninput="drawComp()"></div>
        </div>
        <div class="legend" style="margin-top:14px"><div class="leg-i"><div class="leg-d" style="background:var(--cyan)" aria-hidden="true"></div>Distribution A</div><div class="leg-i"><div class="leg-d" style="background:var(--pink)" aria-hidden="true"></div>Distribution B</div></div>
      </div>
      <div class="explain"><h3>Center vs. Spread</h3><p>Set both Ïƒ equal and slide the means apart â€” that's pure location shift. Then set means equal and change Ïƒ â€” that's pure scale change. These are the two fundamental properties of any distribution.</p></div>
    </div>
  </div>
  <div id="viz-dynamic" style="display:none" role="tabpanel" aria-live="polite"></div>
  <div class="viz-data-summary" id="vizDataSummary"></div>
  <div class="viz-practice-link">
    <button class="viz-practice-btn" onclick="goPage('practice');setUnit(1);">Practice Unit 1: Descriptive Statistics â†’</button>
  </div>
</section>

<!-- ==================== PRACTICE ==================== -->
<section class="page" id="page-practice" role="tabpanel" aria-labelledby="tab-practice">
  <header class="section-header">
    <p class="section-tag" id="practiceUnitTag">Unit 1 â€” Descriptive Statistics</p>
    <h2 class="section-title">Practice <em>Problems</em></h2>
    <p class="section-desc">Practice problems from easy to hard. Work them by hand, then check.</p>
    <button class="focus-btn" id="focusBtn" onclick="toggleFocusMode()" aria-label="Toggle focus mode">ğŸ¯ Focus Mode</button>
    <button class="export-pdf-btn" onclick="exportPracticePDF(currentUnit)" aria-label="Export problems as PDF">ğŸ–¨ Export PDF</button>
    <button class="export-unit-btn" onclick="exportUnitProblems()" aria-label="Export unit problems as JSON">ğŸ“¥ Export Problems</button>
    <button class="rand-prob-btn" onclick="jumpToRandomProblem()" aria-label="Jump to random unsolved problem">ğŸ² Random</button>
  </header>
  <div class="progress-panel" id="progressPanel">
    <button class="progress-toggle" id="progressToggle" aria-expanded="true" onclick="toggleProgressPanel()">Progress Overview &#9662;</button>
    <div class="progress-grid" id="progressGrid" role="status" aria-live="polite"></div>
    <div class="diff-chart-row" id="diffChartRow" style="display:none;text-align:center;padding:8px 0 4px;">
      <div style="font-size:10px;color:var(--muted);font-family:'Space Mono',monospace;margin-bottom:4px;">Difficulty Distribution</div>
      <canvas id="diffChart" width="200" height="50"></canvas>
    </div>
    <div class="session-goal-bar" id="sessionGoalBar">
      <label class="cl" for="sessionGoal">Session Goal:</label>
      <select id="sessionGoal" onchange="updateSessionGoal()">
        <option value="0">No goal</option>
        <option value="5">5 problems</option>
        <option value="10">10 problems</option>
        <option value="15">15 problems</option>
        <option value="20">20 problems</option>
      </select>
      <progress id="goalProgress" max="100" value="0" style="display:none;width:100px;" aria-label="Session goal progress"></progress>
      <span class="goal-progress-text" id="goalProgressText"></span>
    </div>
    <div class="progress-actions" id="progressActions">
      <button class="share-btn" onclick="exportProgressJSON()">Export JSON</button>
      <button class="share-btn" onclick="copyProgressSummary()">Copy Summary</button>
      <label class="share-btn import-label">
        Import <input type="file" id="importFile" accept=".json" onchange="importProgressJSON(this.files[0])" hidden>
      </label>
      <button class="share-btn" onclick="printProblemSet()">Print Set</button>
      <button class="share-btn" onclick="exportNotes()">Export Notes</button>
      <button class="share-btn" onclick="exportBookmarks()">Export Bookmarks</button>
      <button class="share-btn" onclick="exportAllData()">Export All Data</button>
      <button class="share-btn" onclick="toggleCompareMode()" id="compareModeBtn">Compare Mode</button>
      <button class="reset-btn" onclick="resetAllProgress()">Reset All Progress</button>
    </div>
    <div class="milestone-shelf" id="milestoneShelf">
      <h3 class="milestone-title">Badges</h3>
      <div class="milestone-grid" id="milestoneGrid"></div>
    </div>
    <div class="weakspot-panel" id="weakspotPanel">
      <h3 class="weakspot-title">ğŸ¯ Focus Areas</h3>
      <div id="weakspotList"></div>
    </div>
  </div>
  <div class="unit-selector">
    <label class="cl" for="unitSelect">UNIT</label>
    <select id="unitSelect" onchange="setUnit(+this.value)">
      <option value="1">Unit 1: Descriptive Statistics</option>
      <option value="2">Unit 2: Normal Distribution</option>
      <option value="3">Unit 3: Bivariate Data</option>
      <option value="4">Unit 4: Sampling &amp; Design</option>
      <option value="5">Unit 5: Probability</option>
      <option value="6">Unit 6: Random Variables</option>
      <option value="7">Unit 7: Sampling Distributions</option>
      <option value="8">Unit 8: Confidence Intervals</option>
      <option value="9">Unit 9: Hypothesis Testing</option>
      <option value="10">Unit 10: Chi-Square Tests</option>
      <option value="11">Unit 11: Regression Inference</option>
      <option value="12">Unit 12: ANOVA</option>
      <option value="13">Unit 13: Nonparametric Tests</option>
      <option value="14">Unit 14: Bayesian Statistics</option>
    </select>
    <button class="unit-info-btn" onclick="showUnitInfo()" title="Unit overview" aria-label="Unit overview">i</button>
  </div>
  <div class="jump-bar">
    <input type="number" id="jumpInput" class="jump-input" placeholder="Go to #..." min="1" aria-label="Jump to problem by ID" onkeydown="if(event.key==='Enter')jumpToProblem()">
    <button class="jump-btn" onclick="jumpToProblem()">Go</button>
  </div>
  <div class="score-bar" role="status" aria-live="polite">
    <div class="score-track" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><div class="score-fill" id="scoreFill"></div></div>
    <div class="score-text" id="scoreText">0 / 15</div>
    <span class="session-time" id="sessionTime">0s</span>
    <span class="prob-counter" id="probCounter"></span>
    <button class="reset-btn reset-unit-btn" onclick="resetUnit(currentUnit)">Reset Unit</button>
  </div>
  <div class="search-bar" id="searchBar">
  <input type="text" id="searchInput" placeholder="Search problems..." oninput="searchProblems()" aria-label="Search problems">
  <button class="search-clear" id="searchClear" onclick="clearSearch()" style="display:none;">âœ•</button>
</div>
<div class="search-suggestions" id="searchSuggestions">
  <button class="search-chip" onclick="applySearchChip('Hypothesis Test')">Hypothesis Test</button>
  <button class="search-chip" onclick="applySearchChip('Confidence Interval')">Confidence Interval</button>
  <button class="search-chip" onclick="applySearchChip('Normal Distribution')">Normal Distribution</button>
  <button class="search-chip" onclick="applySearchChip('Regression')">Regression</button>
</div>
<div class="sort-bar">
  <span class="mastery-badge" id="masteryBadge" data-level="novice">Novice</span>
  <label class="cl" for="problemSort">Sort:</label>
  <select id="problemSort" onchange="sortProblems(this.value)">
    <option value="default">Default</option>
    <option value="easy-first">Easy â†’ Hard</option>
    <option value="hard-first">Hard â†’ Easy</option>
    <option value="id-asc">ID (Asc)</option>
    <option value="id-desc">ID (Desc)</option>
  </select>
  <button class="expand-all-btn" id="expandAllBtn" onclick="toggleExpandAll()">Expand All</button>
</div>
<div class="topic-focus-bar" id="topicFocusBar" style="display:none;"><span class="topic-focus-label" id="topicFocusLabel"></span><button class="topic-focus-clear" onclick="clearTopicFocus()">âœ• Clear topic filter</button></div>
<div class="filter-bar" id="filterBar">
  <button class="filter-chip active" onclick="filterProblems('all')" data-filter="all">All</button>
  <button class="filter-chip" onclick="filterProblems('unanswered')" data-filter="unanswered">Unanswered</button>
  <button class="filter-chip" onclick="filterProblems('wrong')" data-filter="wrong">Wrong</button>
  <button class="filter-chip" onclick="filterProblems('bookmarked')" data-filter="bookmarked">â˜… Bookmarked</button>
  <button class="filter-chip" onclick="filterProblems('easy')" data-filter="easy">Easy</button>
  <button class="filter-chip" onclick="filterProblems('medium')" data-filter="medium">Medium</button>
  <button class="filter-chip" onclick="filterProblems('hard')" data-filter="hard">Hard</button>
</div>
<div class="hint-usage-info" id="hintUsageInfo"><span class="hint-usage-label" id="hintUsageLabel"></span></div>
<div class="tag-filter-bar" id="tagFilterBar" style="display:none;"></div>
<div class="nlp-bar" id="nlpBar">
  <input type="text" id="nlpInput" placeholder="Try: 'What is the z-score if x=85, mean=70, stdev=5?'" onkeydown="if(event.key==='Enter')solveNLP()" aria-label="Natural language problem input">
  <button onclick="solveNLP()">Solve</button>
</div>
<div class="nlp-history" id="nlpHistory"></div>
<div class="nlp-result" id="nlpResult" style="display:none;"></div>
<div class="formula-panel" id="formulaPanel">
  <div class="formula-search-wrap">
    <input type="search" id="formulaSearch" placeholder="Search formulas..." oninput="filterFormulas(this.value)" aria-label="Search formulas">
    <button class="formula-search-clear" id="formulaSearchClear" onclick="clearFormulaSearch()" aria-label="Clear formula search" style="display:none;">Ã—</button>
  </div>
  <div class="formula-history-row" id="formulaHistoryRow" style="display:none;"></div>
  <button class="formula-fav-filter" id="formulaFavFilter" onclick="toggleFormulaFavFilter(this)">â˜† Favorites</button>
  <button class="formula-toggle" id="formulaToggle" onclick="toggleFormulas()" aria-expanded="false">
    ğŸ“ Formulas <span id="formulaArrow">â–¸</span>
  </button>
  <button class="formula-pin-btn" id="formulaPinBtn" onclick="toggleFormulaPin()" title="Pin formula panel open">ğŸ“Œ</button>
  <div class="formula-unit-nav-row"><button class="formula-unit-nav" id="formulaUnitPrev" onclick="formulaUnitNav(-1)" title="Previous unit formulas">â—€</button><div class="formula-unit-label" id="formulaUnitLabel"></div><button class="formula-unit-nav" id="formulaUnitNext" onclick="formulaUnitNav(1)" title="Next unit formulas">â–¶</button><button class="formula-copy-all-btn" onclick="copyAllFormulas()" title="Copy all formulas">Copy All</button></div>
  <div class="formula-content" id="formulaContent" style="display:none;"></div>
  <div class="formula-resize-handle" id="formulaResizeHandle" title="Drag to resize formula panel"></div>
</div>
<div class="unit-xp-bar-row" id="unitXPBarRow" style="display:none;"><div class="unit-xp-bar-track"><div class="unit-xp-bar-fill" id="unitXPBarFill"></div></div><span class="unit-xp-bar-text" id="unitXPBarText">0 XP earned</span></div>
<div class="diff-insight" id="diffInsight"></div>
<div class="problems" id="probContainer" aria-label="Practice problems"></div>
</section>

<!-- ==================== REVIEW ==================== -->
<section class="page" id="page-review" role="tabpanel" aria-labelledby="tab-review">
  <header class="section-header">
    <p class="section-tag">Spaced Repetition</p>
    <h2 class="section-title">Review <em>Session</em></h2>
    <p class="section-desc" id="reviewDesc">Problems due for review will appear here.</p>
  </header>

  <div class="review-stats" id="reviewStats">
    <div class="review-stat">
      <span class="review-stat-num" id="reviewDueCount">0</span>
      <span class="review-stat-label">Due Today</span>
    </div>
    <div class="review-stat">
      <span class="review-stat-num" id="reviewTotalCount">0</span>
      <span class="review-stat-label">In Deck</span>
    </div>
    <div class="review-stat">
      <span class="review-stat-num" id="reviewMasteredCount">0</span>
      <span class="review-stat-label">Mastered</span>
    </div>
  </div>

  <div id="reviewNextUp" class="review-next-up"></div>

  <div id="reviewContainer">
    <button class="start-review-btn" id="startReviewBtn" onclick="startReview()">
      Start Review Session
    </button>
  </div>

  <div id="reviewCard" style="display:none;">
    <div class="review-card-inner" id="reviewCardInner"></div>
    <div class="review-progress">
      <span id="reviewProgress">0 / 0</span>
    </div>
  </div>
</section>

<textarea id="shareOutput" aria-hidden="true" style="position:absolute;left:-9999px;top:0;"></textarea>
<div class="toast" id="toast" role="status" aria-live="polite"></div>
</main>

<!-- BOTTOM BAR -->
<footer class="bottom-bar" role="status" aria-live="polite" aria-label="Overall progress">
  <div class="bp-track" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><div class="bp-fill" id="bpFill"></div></div>
  <div class="bp-text" id="bpText">0 / 0 topics</div>
</footer>

<div class="pomo-widget" id="pomoWidget">
  <button class="pomo-toggle" id="pomoToggle" onclick="togglePomoPanel()" aria-label="Toggle study timer">â±</button>
  <div class="pomo-panel" id="pomoPanel" style="display:none;">
    <div class="pomo-display" id="pomoDisplay">25:00</div>
    <div class="pomo-label" id="pomoLabel">Focus Time</div>
    <div class="pomo-controls">
      <button onclick="startPomo()" id="pomoStart">Start</button>
      <button onclick="pausePomo()" id="pomoPause" style="display:none;">Pause</button>
      <button onclick="resetPomo()" id="pomoReset">Reset</button>
    </div>
    <div class="pomo-presets">
      <button onclick="setPomoTime(15)" class="pomo-preset">15m</button>
      <button onclick="setPomoTime(25)" class="pomo-preset active">25m</button>
      <button onclick="setPomoTime(45)" class="pomo-preset">45m</button>
    </div>
    <div class="pomo-stats">
      <span id="pomoSessions">0</span> sessions today
    </div>
    <div class="pomodoro-history" id="pomodoroHistory"></div>
  </div>
</div>
<div class="shortcuts-overlay" id="shortcutsOverlay" style="display:none;" onclick="toggleShortcutsHelp()">
  <div class="shortcuts-modal" onclick="event.stopPropagation();">
    <h3>Keyboard Shortcuts</h3>
    <div class="shortcut-section">Navigation</div>
    <div class="shortcut-row"><kbd>1</kbd>&ndash;<kbd>5</kbd> Home / Roadmap / Visualizer / Practice / Review</div>
    <div class="shortcut-row"><kbd>6</kbd> Achievements &nbsp;<kbd>7</kbd> Flashcards &nbsp;<kbd>8</kbd> Create</div>
    <div class="shortcut-row"><kbd>R</kbd> Jump to Review</div>
    <div class="shortcut-section">Practice</div>
    <div class="shortcut-row"><kbd>J</kbd> / <kbd>K</kbd> Next / Prev Problem</div>
    <div class="shortcut-section">Flashcards</div>
    <div class="shortcut-row"><kbd>Space</kbd> Flip Card</div>
    <div class="shortcut-row"><kbd>â†’</kbd> Mark Know</div>
    <div class="shortcut-row"><kbd>â†</kbd> Mark Unsure</div>
    <div class="shortcut-section">Interface</div>
    <div class="shortcut-row"><kbd>F</kbd> Toggle Focus Mode (Practice)</div>
    <div class="shortcut-row"><kbd>T</kbd> Toggle Timer</div>
    <div class="shortcut-row"><kbd>D</kbd> Toggle Theme</div>
    <div class="shortcut-row"><kbd>?</kbd> This Help</div>
    <div class="shortcut-row"><kbd>Esc</kbd> Close Panel / Exit Focus</div>
    <button class="shortcut-dl-btn" onclick="downloadShortcutCheatsheet()">&#8595; Download Cheatsheet</button>
    <button onclick="toggleShortcutsHelp()">Close</button>
  </div>
</div>
<script src="scripts/stats_hub.js" defer></script>
<section class="page" id="page-create" role="tabpanel" aria-labelledby="tab-create">
  <header class="section-header">
    <p class="section-tag">Create Your Own</p>
    <h2 class="section-title">Problem <em>Builder</em></h2>
    <p class="section-desc">Create problems to reinforce your learning.</p>
  </header>
  <div class="deck-actions">
    <button class="share-btn" onclick="exportCustomDeck()">ğŸ“¤ Export Deck</button>
    <button class="share-btn" onclick="importCustomDeck()">ğŸ“¥ Import Deck</button>
  </div>
  <form class="create-form" id="createForm" onsubmit="event.preventDefault();saveCustomProblem();">
    <div class="cf-row">
      <label class="cf-label">Unit:
        <select id="cpUnit"></select>
      </label>
      <label class="cf-label">Difficulty:
        <select id="cpDiff"><option value="easy">Easy</option><option value="medium" selected>Medium</option><option value="hard">Hard</option></select>
      </label>
      <label class="cf-label">Type:
        <select id="cpType" onchange="toggleCreateType()"><option value="mc">Multiple Choice</option><option value="fr">Free Response</option></select>
      </label>
    </div>
    <label class="cf-label">Topic: <input type="text" id="cpTopic" required placeholder="e.g., Z-score calculation"></label>
    <label class="cf-label">Question: <textarea id="cpQuestion" required rows="3" placeholder="Write your question..."></textarea></label>
    <div id="cpMCFields">
      <label class="cf-label">Choice A: <input type="text" id="cpA"></label>
      <label class="cf-label">Choice B: <input type="text" id="cpB"></label>
      <label class="cf-label">Choice C: <input type="text" id="cpC"></label>
      <label class="cf-label">Choice D: <input type="text" id="cpD"></label>
      <label class="cf-label">Correct:
        <select id="cpMCAns"><option value="0">A</option><option value="1">B</option><option value="2">C</option><option value="3">D</option></select>
      </label>
    </div>
    <div id="cpFRFields" style="display:none;">
      <label class="cf-label">Answer (number): <input type="number" id="cpFRAns" step="any"></label>
      <label class="cf-label">Tolerance: <input type="number" id="cpTol" value="0.1" step="0.01"></label>
    </div>
    <label class="cf-label">Explanation: <textarea id="cpExplanation" required rows="2" placeholder="Step-by-step solution..."></textarea></label>
    <label class="cf-label">Hint (optional): <input type="text" id="cpHint" placeholder="A nudge toward the approach..."></label>
    <button type="submit" class="create-submit">Save Problem +10 XP</button>
  </form>
  <div class="custom-problems-list">
    <h3 class="achieve-section-title">Your Custom Problems (<span id="cpCount">0</span>)</h3>
    <div id="cpList"></div>
  </div>
</section>
<section class="page" id="page-flashcards" role="tabpanel" aria-labelledby="tab-flashcards">
  <header class="section-header">
    <p class="section-tag">Quick Review</p>
    <h2 class="section-title">Flash<em>cards</em></h2>
    <p class="section-desc">Tap to flip. Arrow keys to advance. Space to flip.</p>
  </header>
  <div class="fc-unit-select">
    <label for="fcUnitSelect">Unit:</label>
    <select id="fcUnitSelect" onchange="buildFlashcards(+this.value)"></select>
    <button class="fc-mode-btn active" id="fcModeFlash" onclick="setFCMode('flash')">Flashcards</button>
    <button class="fc-mode-btn" id="fcModeMatch" onclick="setFCMode('match')">Match Game</button>
    <button class="fc-mode-btn" id="fcModeBuild" onclick="setFCMode('build')">Formula Builder</button>
  </div>
  <div id="fcFlashMode">
    <div class="fc-progress-bar"><div class="fc-progress-fill" id="fcProgressFill" style="width:0%"></div></div>
    <div class="fc-container" id="fcContainer"></div>
    <div class="fc-controls">
      <button onclick="fcPrev()" aria-label="Previous card">â† Prev</button>
      <span id="fcProgress">- / -</span>
      <button onclick="fcNext()" aria-label="Next card">Next â†’</button>
    </div>
    <div class="fc-actions">
      <button class="fc-know" onclick="fcMark(true)">âœ“ I know this</button>
      <button class="fc-unsure" onclick="fcMark(false)">âœ— Still learning</button>
    </div>
  </div>
  <div id="fcMatchMode" style="display:none;">
    <div class="match-board" id="matchBoard"></div>
    <div class="match-status" id="matchStatus"></div>
  </div>
  <div id="fcBuildMode" style="display:none;">
    <div class="builder-target" id="builderTarget"></div>
    <div class="builder-pieces" id="builderPieces"></div>
    <div class="builder-answer" id="builderAnswer"></div>
    <div class="builder-status" id="builderStatus"></div>
    <button class="fc-know" onclick="builderCheck()">Check</button>
    <button class="fc-unsure" onclick="startFormulaBuilder(+document.getElementById('fcUnitSelect').value||1)">New Formula</button>
  </div>
</section>
<section class="page" id="page-achievements" role="tabpanel" aria-labelledby="tab-achievements">
  <header class="section-header">
    <p class="section-tag">Your Progress</p>
    <h2 class="section-title">Achievement <em>Showcase</em></h2>
    <p class="section-desc">Track your badges, activity, and stats over time.</p>
  </header>
  <div class="achieve-stats" id="achieveStats"></div>
  <div class="achieve-badges" id="achieveBadges">
    <h3 class="achieve-section-title">Badges Earned</h3>
    <div id="achieveBadgeGrid"></div>
  </div>
  <div class="leaderboard-widget" id="leaderboardWidget">
    <h3 class="achieve-section-title">ğŸ† Leaderboard</h3>
    <div class="leaderboard-rows" id="leaderboardRows"></div>
  </div>
  <div class="streak-freeze-card" id="streakFreezeCard">
    <h3 class="achieve-section-title">â„ï¸ Streak Freeze</h3>
    <p class="sf-desc">Protect your streak for 1 day by spending 100 XP.</p>
    <div id="sfStatus"></div>
    <button class="sf-btn" id="sfBtn" onclick="activateStreakFreeze()">Activate Freeze (100 XP)</button>
  </div>
  <div class="achieve-history" id="achieveHistory">
    <h3 class="achieve-section-title">Activity Heatmap (Last 90 Days)</h3>
    <div class="heatmap" id="heatmapGrid"></div>
  </div>
  <div class="analytics-section">
    <h3 class="achieve-section-title">ğŸ“ˆ Learning Analytics</h3>
    <div class="analytics-tabs">
      <button class="analytics-tab active" onclick="showAnalytics('accuracy',event)">Accuracy</button>
      <button class="analytics-tab" onclick="showAnalytics('xp',event)">XP Over Time</button>
      <button class="analytics-tab" onclick="showAnalytics('units',event)">Unit Breakdown</button>
    </div>
    <canvas id="analyticsCanvas" height="220" style="width:100%;max-width:600px;display:block;margin-top:12px;" aria-label="Analytics chart" role="img"></canvas>
  </div>
  <div class="calendar-section">
    <h3 class="achieve-section-title">ğŸ“… Study Calendar</h3>
    <div class="cal-nav">
      <button onclick="calPrev()">â—€</button>
      <span id="calMonth"></span>
      <button onclick="calNext()">â–¶</button>
    </div>
    <div class="cal-grid" id="calGrid"></div>
  </div>
  <div style="text-align:center;margin:16px 0;">
    <button class="cert-btn" onclick="generateCertificate()">ğŸ“ Get Certificate</button>
  </div>
  <div id="generalCertArea" style="text-align:center;margin:8px 0;"></div>
</section>
<div class="install-banner" id="installBanner" style="display:none;">
  <span class="install-text">ğŸ“± Install Stats Hub for offline access</span>
  <button class="install-btn" id="installBtn" onclick="installPWA()">Install</button>
  <button class="install-dismiss" onclick="dismissInstall()" aria-label="Dismiss">âœ•</button>
</div>
<div class="tutor-panel" id="tutorPanel" style="display:none;">
  <div class="tutor-header">
    <span>ğŸ¤– Stats Tutor</span>
    <button onclick="toggleTutor()" aria-label="Close tutor">âœ•</button>
  </div>
  <div class="tutor-messages" id="tutorMessages"></div>
  <div class="tutor-input-row">
    <input type="text" id="tutorInput" placeholder="Ask a stats question..." onkeydown="if(event.key==='Enter')sendTutorMessage()" aria-label="Tutor input">
    <button onclick="sendTutorMessage()">Send</button>
  </div>
</div>
<button class="tutor-toggle" id="tutorToggle" onclick="toggleTutor()" aria-label="Open stats tutor">ğŸ¤–</button>
<div id="a11yAnnounce" aria-live="polite" aria-atomic="true" class="sr-only"></div>
<div class="cert-modal" id="rmCertModal" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="rmCertTitle"><div class="cert-body"><div class="cert-icon">ğŸ“</div><h2 class="cert-title" id="rmCertTitle">Roadmap Complete!</h2><p class="cert-desc">You've checked every topic in the Quant Roadmap. Outstanding work!</p><button class="cert-close-btn" onclick="document.getElementById('rmCertModal').style.display='none'">Close</button></div></div>
</body>
</html>


